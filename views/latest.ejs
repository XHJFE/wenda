
<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="zh-CN">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="zh-CN">
<![endif]-->
<!--[if !(IE 6) | !(IE 7)]><!-->
<html lang="zh-CN">
<!--<![endif]-->
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>【长沙楼盘_长沙新房_长沙楼盘价格】—新环境房屋网</title>
<meta http-equiv="Cache-Control" content="no-transform"/>
<meta http-equiv="Cache-Control" content="no-siteapp"/>
<meta name="keywords" content="长沙新房，长沙楼盘，长沙房价" />
<meta name="description" content="新环境新房频道为您精选长沙新房、提供长沙楼盘信息及房价，更多长沙楼盘信息尽在新环境房屋网。" />
<link href="../css/list.css" rel="stylesheet" />
<link href="../css/wendas.css" rel="stylesheet" />
<!--[if lt IE 9]>
  <script src="http://libs.furong.gov.cn/html5/html5.js"></script>
  <script src="http://libs.furong.gov.cn/selectivizr/selectivizr.js"></script>
<![endif]-->


<% include include/cssjs %>

</head>

<body>
    
<!-- 顶部导航栏 -->
<%- include('include/nav', {menus: menus}) %>
<!-- 顶部菜单栏 -->
<%- include('include/header', {
    city: city, 
    currentCityId: currentCityId,
    active: 'dynamic',
    search: true
})  %>
<!-- 搜索栏 -->
<% include include/login %>

<!-- 面包屑 -->
<%- include('include/breadcrumb', {
    list: [{
        name: '问答动态',
        url: '#'
    }]
}) %>

<div class="wddt_big_wrap">
    <div class="wddt_content_wrap">
        <p class="title">最新问题
            <!-- <span class="dt_shaixuan"><i class="active">最新</i><i>热度</i></span> -->
        </p>
        
        <div class="wenda_content">
            <% questionList.content.forEach((item, index) => { %>
            <div class="wd_content">
               <!------------------右边有图片的时候就在这里加个img_detail类名---->
               <a href="/questions_info/<%= item.problemAskId %>" class="<%= item.img ? 'img_detail': ''  %>">
                   <p class="title"><%= item.problemTitle %></p>
                   <p class="name"><%= item.questionerName %></p>
                   <% if (item.newProblemAnswer) { %>
                    <p class="content answer" data-url="/personal_answer?id=<%= item.problemAskId %>&answerId=<%= item.newProblemAnswer.problemAnswerId %>"><%= item.newProblemAnswer.answerContent %></p>
                    <% } %>
                   <p class="huida"><span><%= item.answerNum %>条回答</span></p>
                   <% if (item.img) {%>
                    <span class="img">
                        <img src="<%= item.img %>"/>
                    </span>
                    <% } %>
               </a>

               <% if (item.isFocus) { %>
                <span 
                    class="guanzhu" 
                    onclick="removeFocus('<%= item.problemAskId %>', '<%= index %>', '<%= item.questionerId %>')">
                    取消关注
                </span>
                <% } else { %>
                <span 
                    class="guanzhu active" 
                    onclick="addFocus('<%= item.problemAskId %>', '<%= index %>', '<%= item.questionerId %>')">
                    关注
                </span>
                <% } %>
           </div>
           <% }) %>
           <!---分页---->
            <div class="pager" id="pager"></div>
        </div>
    </div>
        
    <!---右侧内容---->
    <div class="wytw_right_wrap">
        <p class="title">
            <a href="/ask_questions" target="_blank">
                <img src="../images/wytw_img.png"/>
            </a>
        </p>
        <div class="wytw_content">
        <a href="###"><img src="../images/wd_01.png"/><span>我提出的问题</span></a>
        <a href="/answer"><img src="../images/wd_02.png"/><span>我回答的问题</span></a>
        <a href="###"><img src="../images/wd_03.png"/><span>我的关注</span></a>
        </div>

        <!---问答分类---->
        <div class="wendafenlei_right">
            <p class="right_title"><span>问答</span>分类<i></i></p>

            <% classData.forEach(item => { %>
            <div class="fenlei_list_wrap">
               <p class="title"><%= item.typeName %></p>
               <div class="fenlei_list">
                   <% item.labels.forEach(child => { %>
                   <a href="/search_result?labelName=<%= child.labelName %>"><span><%= child.labelName %></span></a>
                   <% }) %>
                </div>
              </div>
            <% }) %>
            <a href="/classify" target="_blank" class="gdfl_btn"><span>更多分类</span><img src="../images/wd_04.png"/></a>
        </div>


          <!---热门回答---->
         <div class="remenhuida_right">
             <!-- <%= JSON.stringify(hotQuestion) %> -->
             <p class="right_title"><span>热门</span>问答<i></i></p>
             <div class="remenhuida_right_content">
                 <% hotQuestion.forEach(item => { %>
                 <a href="/questions_info/<%= item.problemAskId %>"><span><%= item.problemTitle %></span><i><%= item.answerNum %>个回答</i></a>
                 <% }) %>
             </div>
         </div>

            <!---最新回答---->
            <div class="remenhuida_right">
                 <p class="right_title"><span>最新</span>回答<i></i></p>
                 <div class="remenhuida_right_content">
                    <% hotQuestion.forEach(item => { %>
                        <a href="/questions_info/<%= item.problemAskId %>"><span><%= item.problemTitle %></span><i><%= item.answerNum %>个回答</i></a>
                    <% }) %>            
                 </div>
             </div>
    </div>

</div>
<div id="xh_kj_login"></div>
</body>
<script>
    var login = null
    require(['pager', 'pc_login_reg'], function(pager, l) {
        login = l
        var p = new pager({
            total: "<%= questionList.totalElements %>",
            pageno: Number("<%= questionList.number %>") + 1,
            pagesize: "<%= questionList.size %>",
            view: 2,
            useGoto: false
        });
        $('#pager').after(p.get());

        $('.answer').click(function(){
            var url = $(this).attr('data-url')
            window.location.href = url
            return false
        })

        
    })
    /**
     * 关注
     * @param {String} askId 问题id 
     */
     function addFocus(askId, index, userId) {
        $.ajax({
            url: '/addFocus/',
            type: 'POST',
            data: {
                askId: askId,
                userId: userId
            },
            success: function(data) {
                if (data.status == 1) {
                    var html = "<span class='guanzhu' onclick='removeFocus(\""+askId+"\", "+index+", \""+userId+"\")'>取消关注</span>"
                    $('.guanzhu').get(index).remove()
                    $('.wd_content').eq(index).append(html)

                } else if (data.status == 506) {
                    login.login(function() {
                        console.log('登陆成功')
                    })
                }
            }
        })
    }

    /**
     * 取消关注
     * @param {String} askId 问题id 
     */
     function removeFocus(askId, index, userId) {
        $.ajax({
            url: '/removeFocus/',
            type: 'POST',
            data: {
                askId: askId,
                userId: userId
            },
            success: function(data) {
                if (data.status == 1) {
                    var html = "<span class='guanzhu active' onclick='addFocus(\""+askId+"\", "+index+", \""+userId+"\")'>关注</span>"
                    $('.guanzhu').get(index).remove()
                    $('.wd_content').eq(index).append(html)
                } else if (data.status == 506) {
                    login.login(function() {
                        console.log('登陆成功')
                    })
                }
            },
        })
    }



</script>
</html>
